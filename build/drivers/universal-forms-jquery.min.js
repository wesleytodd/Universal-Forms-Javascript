var UniversalForms=function(){var e=function(t,i,r,o){if(!(this instanceof e))return new e(t,i,r,o);if("string"!=typeof t)throw new TypeError("A name is required for all fields");if("string"!=typeof i)throw new TypeError("A type is required for all fields");if("object"!=typeof r&&(r={}),r.rules===void 0)r.rules=[];else if(!(r.rules instanceof Array))throw new TypeError("the rules must be defined as an array");if(r.attributes=r.attributes||{},r.attributes.name=t,r.attributes.id=r.id||"",-1===["textarea","select"].indexOf(i)&&(r.attributes.type=i,r.attributes.value=r.value||""),this.name=t,this.type=i,this.value=r.value||"",this.label=r.label,this.attributes=r.attributes,this.rules=r.rules,this.fieldJSON=r,this.errors={},-1!==["select","radio","checkbox"].indexOf(this.type)&&(this.options=r.options),this.opts={},e.defaultOpts!==void 0)for(var s in e.defaultOpts)this.opts[s]=e.defaultOpts[s];if(o!==void 0)for(var s in o)this.opts[s]=o[s];e.trigger(this,"init")};e.prototype.setError=function(t,i){this.errors[t]=i,e.trigger(this,"setError")},e.prototype.clearError=function(t){return this.errors[t]!==void 0?delete this.errors[t]:(t===void 0&&(this.errors={}),e.trigger(this,"clearError"),void 0)},e.prototype.serialize=function(e){var t={name:this.name,type:this.type,value:this.value,label:this.label,rules:this.rules,errors:this.errors};return-1!==["select","radio","checkbox"].indexOf(this.type)&&(t.options=this.options),e=e!==void 0?e:!1,e?JSON.stringify(t):t},e.on=function(t,i){e._hooks===void 0&&(e._hooks={}),e._hooks[t]===void 0&&(e._hooks[t]=[]),e._hooks[t].push(i)},e.trigger=function(t,i){if(void 0!==e._hooks&&"undefined"!==e._hooks[i])for(var r=0,o=e._hooks[i].length;o>r;r++)e._hooks[i][r].apply(t,Array.prototype.slice.call(arguments,2))};var t=function(e,i){if(!(this instanceof t))return new t(e,i);if(e===void 0&&(e={}),e.attributes=e.attributes||{},e.attributes.id=e.id,e.attributes.method=e.method||"POST",e.attributes.action=e.action,this.attributes=e.attributes,this.fields={},this.formJSON=e,e.fields===void 0)e.fields=[];else if(!(e.fields instanceof Array))throw new TypeError("Fields must be defined as an array");for(var r=e.fields.length,o=0;r>o;o++)this.addField(e.fields[o].name,e.fields[o].type,e.fields[o]);if(this.opts={},t.defaultOpts!==void 0)for(var s in t.defaultOpts)this.opts[s]=t.defaultOpts[s];if(i!==void 0)for(var s in i)this.opts[s]=i[s];t.trigger(this,"init")};t.prototype.addField=function(t,i,r,o){return t instanceof e?this.fields[t.name]=t:this.fields[t]=new e(t,i,r,o)},t.prototype.removeField=function(e){this.fields[e]!==void 0&&delete this.fields[e],t.trigger(this,"removeField")},t.prototype.eachField=function(e,t){for(var i in this.fields)if(e.call(t||this,this.fields[i],i,this.fields)===!1)break},t.on=function(e,i){t._hooks===void 0&&(t._hooks={}),t._hooks[e]===void 0&&(t._hooks[e]=[]),t._hooks[e].push(i)},t.trigger=function(e,i){if(void 0!==t._hooks&&"undefined"!==t._hooks[i])for(var r=0,o=t._hooks[i].length;o>r;r++)t._hooks[i][r].apply(e,Array.prototype.slice.call(arguments,2))},t.on("init",function(){this.$el=$("#"+this.attributes.id)});var i=/([a-z]+)(?:\[(.*)\])?/,r={required:{method:"required",callback:function(){return!0}},email:{method:"email",callback:function(){return!0}},length:{method:"rangelength",callback:function(e,t){return(e===void 0||""===e)&&(e=0),(t===void 0||""===t)&&(t=Number.MAX_VALUE),[e,t]}},alpha:{method:"alpha",callback:function(){return!0}},matches:{method:"equalTo",callback:function(e){return"[name="+e+"]"}}};$.validator.addMethod("alpha",function(e){return/[a-z]*/i.test(e)},"Please use only alphabetical characters"),t.prototype.validate=function(e){e=$.extend({rules:{}},e),this.eachField(function(t){if(t.rules.length>0){e.rules[t.name]={};for(var o=0,s=t.rules.length;s>o;o++){var n=i.exec(t.rules[o]),a=n[1],l=[];n.length>2&&n[2]!==void 0&&(l=n[2].split(",")),e.rules[t.name][r[a].method]=r[a].callback.apply(this,l)}}}),this.$el.validate(e)},"undefined"!=typeof exports?(exports.Field=e,exports.Form=t):"undefined"!=typeof require&&"function"==typeof define?define(function(){return{Form:t,Field:e}}):(window.UniversalForms=window.UniversalForms||{},window.UniversalForms.Field=e,window.UniversalForms.Form=t)}();